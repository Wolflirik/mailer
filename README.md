# mailer
<h1>Выгрузка заказов с Яндекс delivery и рассылка сообщений.</h1>

<p>При оформлении заказа и отправке его в определенную службу доставки в YandexDelivery,
получатель не будет уведомлен о сроках доставки и месте получения товара.</p>

<p>Данный скрипт исправляет это;) 
Вам всего лишь необходимо поместить его на хостинг, записав в <a href="https://github.com/Wolflirik/mailer/blob/master/libs/config.php">config.php</a> данные своего магазина.</p>

<p>Автоматического создания баз данных при инициализации скрипта не было предусмотрено, потому на данный момент придется создать их вручную. 
Для этого войдите в phpMyAdmin создайте новую базу данных и импортируйте в нее файл: <a href="https://github.com/Wolflirik/mailer/blob/master/mailer_new.sql">mailer_new.sql</a>.</p>

<p>После регистрации вы сможете перейти в админ-панель, в которой настроить шаблоны писем под каждую службу.</p>
<p>Для начала обновите список служб доставки.</p>
<p>После успешной перезагрузки страницы появится список служб.</p>

<p>У каждой службы присутствует 2 поля:</p>
<ol>
 <li>Шаблон для пункта самовывоза</li>
 <li>Шаблон для курьерской доставки</li>
</ol>

<p>В них необходимо записать текст письма с использованием переменных:</p>
<pre>
Здравствуйте %first_name%
Ваш заказ был передан службе доставки %delivery_name%. 
По факту поступления заказа в пункт выдачи вы получите смс-уведомление. 
Вы также можете самостоятельно отслеживать движение заказа. 
Трек-номер: %track% 
Отслеживать можно здесь: <a href="https://kirillvolkov.me/">Адрес сайта службы доставки</a>
Заказ выдадут только тому, на кого он оформлен при предъявлении паспорта. 
Срок хранения заказа в пункте выдачи составляет 7 дней. В случае если заказ не будет забран в указанный интервал, он вернется обратно к нам. Повторная отправка заказа оплачивается полностью. В случае отказа от заказа деньги за доставку не возвращаются.
Получатель:%full_name% 
Номер на который придет смс-уведомление: %user_phone% 
Тип доставки: курьерская 
Адрес доставки:%address_string% 
Как найти пункт выдачи:%text_map% //Комментарий к заказу в админ панели YandexDelivery
Если у вас возникнут вопросы, то вы можете обратиться напрямую в службу доставки %delivery_name% по номеру телефона +7 (800) 250-44-34 или к нам.
</pre>

<p>Переменные доступны в админке скрипта в шапке.</p>
<pre>
%delivery_name% - Имя службы доставки
%track% - Трек номер
%full_name% - Полное имя получателя
%user_phone% - Телефон получателя
%address_string% - Адрес доставки (пункт выдачи или адрес для курьера)
%first_name% - Имя
%text_map% - Схема проезда
</pre>

<p>Для работы необходим cron, исполняемый файл - <a href="https://github.com/Wolflirik/mailer/blob/master/mailer.php">mailer.php</a></p>

